<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Speak Eu - বহুভাষাভিত্তিক ভাষা শেখার অ্যাপ</title>
<style>
  /* Reset and global */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f9fbfd;
    color: #222;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  /* HEADER */
  header {
    background: #003366;
    color: white;
    padding: 1.2rem 2rem;
    font-weight: 900;
    font-size: 1.8rem;
    text-align: center;
    box-shadow: 0 3px 6px rgba(0,0,0,0.25);
    position: relative;
    user-select:none;
  }
  /* 3-dot menu */
  #settingsIcon {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 28px;
    height: 28px;
    cursor: pointer;
  }
  #settingsIcon div {
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    margin: 3px auto;
  }
  #settingsMenu {
    position: absolute;
    right: 20px;
    top: 56px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.18);
    width: 220px;
    font-size: 0.95rem;
    color: #222;
    display: none;
    z-index: 100;
  }
  #settingsMenu label {
    display: block;
    padding: 10px 16px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
    user-select:none;
  }
  #settingsMenu label:hover {
    background: #e6f0ff;
  }
  #settingsMenu .close-settings {
    border-bottom: none;
    text-align: center;
    color: #0052cc;
    font-weight: 700;
  }
  /* THEMES */
  body.light-theme {
    background: #f9fbfd;
    color: #222;
  }
  body.light-theme header {
    background: #003366;
    color: white;
  }
  body.dark-theme {
    background: #121212;
    color: #ddd;
  }
  body.dark-theme header {
    background: #1a1a1a;
    color: #ddd;
  }
  /* LOGIN PAGE */
  #loginPage {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #loginContainer {
    background: white;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    width: 320px;
  }
  body.dark-theme #loginContainer {
    background: #222;
    color: #ddd;
  }
  #loginContainer h1 {
    text-align: center;
    margin-bottom: 1.5rem;
    font-weight: 900;
    font-size: 1.8rem;
  }
  #loginContainer input {
    width: 100%;
    padding: 0.55rem;
    margin-bottom: 1.1rem;
    border: 1.5px solid #0052cc;
    border-radius: 6px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  #loginContainer input:focus {
    border-color: #003a99;
    outline: none;
  }
  #loginContainer button {
    width: 100%;
    padding: 0.75rem;
    background: #0052cc;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    user-select:none;
  }
  #loginContainer button:hover {
    background: #003a99;
  }
  #loginErrorMsg {
    color: red;
    font-weight: 700;
    margin-bottom: 1rem;
    min-height: 1.2rem;
    text-align:center;
  }

  /* MAIN APP */
  #appContainer {
    flex-grow: 1;
    max-width: 1100px;
    margin: 1rem auto 2rem;
    padding: 1rem 2rem;
    background: white;
    border-radius: 14px;
    box-shadow: 0 22px 50px rgba(0,0,0,0.12);
    display: none;
    flex-direction: column;
    position: relative;
  }
  body.dark-theme #appContainer {
    background: #222;
    color: #ddd;
  }

  /* LANDING PAGE - COUNTRY SELECT */
  #landingPage {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  #landingPage h2 {
    font-weight: 900;
    font-size: 2rem;
    margin-bottom: 1rem;
    text-align: center;
  }
  #countrySelector {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
  }
  .country-card {
    display: flex;
    align-items: center;
    gap: 8px;
    border: 1.75px solid #0052cc;
    border-radius: 10px;
    background: #e6f0ff;
    cursor: pointer;
    padding: 0.7rem 1.3rem;
    font-weight: 700;
    font-size: 1.1rem;
    min-width: 220px;
    user-select:none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  .country-card:hover, .country-card:focus {
    background-color: #c4d9ff;
    outline: none;
    box-shadow: 0 0 12px #0052ccaa;
  }
  .country-card img {
    width: 32px;
    height: 20px;
    object-fit: contain;
    border-radius: 3px;
    flex-shrink: 0;
    user-select:none;
  }

  /* PROFILE SECTION */
  .profile-section {
    background: #e6f0ff;
    border: 1.5px solid #a0c1ff;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    max-width: 420px;
    margin: 1rem auto;
    user-select:none;
  }
  .profile-section h3 {
    margin: 0 0 0.5rem 0;
    color: #00205c;
  }
  .profile-section .profile-info {
    margin-bottom: 0.5rem;
    font-size: 1.05rem;
  }
  .profile-section button {
    background-color: #0052cc;
    color: white;
    border: none;
    padding: 0.6rem 1.3rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 700;
    user-select:none;
  }
  .profile-section button:hover {
    background-color: #003a99;
  }
  /* Tabs */
  .tabs {
    display: flex;
    gap: 1rem;
    margin: 1rem 0 1.5rem;
    justify-content: center;
  }
  .tabs button {
    cursor: pointer;
    background: #dbe5ff;
    color: #003366;
    border: none;
    padding: 0.55rem 1.2rem;
    font-weight: 700;
    font-size: 1.1rem;
    border-radius: 12px;
    user-select: none;
    transition: background-color 0.25s ease;
    min-width: 120px;
  }
  .tabs button.active {
    background: #0052cc;
    color: white;
    box-shadow: 0 4px 12px rgba(0, 82, 204, 0.6);
  }

  /* Practice Table */
  .table-container {
    border: 1.5px solid #ccc;
    border-radius: 12px;
    overflow-x: auto;
    max-height: 520px;
    margin: 0 auto 1.5rem;
    width: 100%;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    min-width: 720px;
  }
  th, td {
    padding: 0.85rem 1.3rem;
    text-align: left;
    border-bottom: 1px solid #ddd;
    vertical-align: top;
    font-size: 1rem;
    user-select:none;
  }
  th {
    background-color: #f2f2f2;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  body.dark-theme th {
    background-color: #333;
    color: #ddd;
  }

  /* Quiz Section */
  .quiz-container {
    max-width: 750px;
    margin: 0 auto 2rem;
  }
  .quiz-question {
    font-weight: 900;
    font-size: 1.25rem;
    margin-bottom: 1rem;
    line-height: 1.3;
    user-select:none;
  }
  .quiz-options {
    list-style: none;
    padding-left: 0;
    margin-bottom: 1.2rem;
  }
  .quiz-options li {
    margin-bottom: 1rem;
  }
  .quiz-options label {
    display: block;
    cursor: pointer;
    background: #e7eaf6;
    padding: 0.55rem 1.2rem;
    border-radius: 10px;
    user-select:none;
    transition: background-color 0.3s ease;
    font-weight: 600;
    font-size: 1rem;
  }
  .quiz-options input[type="radio"] {
    margin-right: 12px;
  }
  .quiz-options label:hover {
    background-color: #c8d4ff;
  }

  /* Quiz feedback */
  #quizFeedback {
    font-weight: 700;
    margin-top: 0.3rem;
    min-height: 1.3rem;
    user-select:none;
  }
  #quizFeedback.correct {
    color: green;
  }
  #quizFeedback.incorrect {
    color: #c71f1f;
  }

  /* Quiz score */
  #quizScore {
    font-weight: 800;
    margin-top: 1rem;
    text-align: center;
    user-select:none;
  }

  /* Advertisement styles */
  .ad-banner {
    background-color: #dedede;
    border-radius: 10px;
    color: #444;
    font-weight: 700;
    font-size: 1rem;
    text-align: center;
    padding: 0.8rem;
    margin: 1rem auto;
    max-width: 720px;
    user-select:none;
    box-shadow: inset 0 0 6px #bbb;
  }
  body.dark-theme .ad-banner {
    background-color: #444;
    color: #ddd;
    box-shadow: inset 0 0 8px #666;
  }

  /* Responsive */
  @media (max-width: 900px) {
    #appContainer {
      padding: 1rem 1rem;
      max-width: 100%;
    }
    .table-container {
      max-height: 350px;
    }
    .quiz-container {
      max-width: 100%;
      padding: 0 0.5rem;
    }
    .country-card {
      min-width: 160px;
      font-size: 1rem;
    }
  }
  @media (max-width: 480px) {
    header {
      font-size: 1.4rem;
      padding: 1rem 1rem;
    }
    /* Make buttons smaller */
    .tabs button {
      font-size: 1rem;
      padding: 0.5rem 0.9rem;
    }
  }
</style>
</head>
<body class="light-theme">

<header>
  Speak Eu - বহুভাষাভিত্তিক ভাষা শেখার অ্যাপ
  <div id="settingsIcon" aria-label="সেটিংস মেনু" role="button" tabindex="0" title="সেটিংস মেনু">
    <div></div><div></div><div></div>
  </div>
  <div id="settingsMenu" aria-label="সেটিংস মেনু" role="menu" tabindex="-1" aria-hidden="true">
    <label for="themeSelect" role="menuitem">থিম পরিবর্তন করুন:</label>
    <select id="themeSelect" aria-label="থিম পরিবর্তন করুন" style="width:100%;padding:6px 8px;margin-bottom:10px;border-radius:5px;border:1px solid #aaa;font-size:1rem;">
      <option value="light">লাইট মোড</option>
      <option value="dark">ডার্ক মোড</option>
    </select>
    <label role="menuitem" class="close-settings" tabindex="0" id="settingsCloseBtn">বন্ধ করুন</label>
  </div>
</header>

<!-- LOGIN PAGE -->
<section id="loginPage">
  <div id="loginContainer" role="main" aria-label="লগইন ফর্ম">
    <h1>লগইন করুন</h1>
    <div id="loginErrorMsg" aria-live="assertive" aria-atomic="true"></div>
    <input type="text" id="firstName" placeholder="প্রথম নাম" autocomplete="off" required aria-required="true" />
    <input type="text" id="lastName" placeholder="শেষ নাম" autocomplete="off" required aria-required="true" />
    <input type="password" id="password" placeholder="পাসওয়ার্ড" autocomplete="off" required aria-required="true" />
    <button id="loginButton" aria-label="লগইন করুন">লগইন</button>
  </div>
</section>

<!-- MAIN APP CONTAINER -->
<section id="appContainer" aria-label="প্রধান অ্যাপ">

  <!-- LANDING PAGE - COUNTRY SELECTION -->
  <div id="landingPage" role="main" aria-label="দেশ নির্বাচন পাতা" aria-live="polite" style="display:none;">
    <h2>দেশ নির্বাচন করুন</h2>
    <div id="countrySelector" role="list" aria-label="দেশের তালিকা">
      <!-- Countries will be dynamically injected -->
    </div>
  </div>

  <!-- COUNTRY APP CONTENT -->
  <div id="countryAppContainer" style="display:none; flex-direction: column;">
    <!-- PROFILE -->
    <section id="profileSection" class="profile-section" aria-label="ব্যবহারকারীর প্রোফাইল">
      <h3>আপনার প্রোফাইল তৈরি করুন</h3>
      <div id="profileMsg" style="min-height:1.25rem; font-weight:700; margin-bottom:0.8rem;"></div>
      <input type="text" id="profileNameInput" placeholder="আপনার নাম" aria-label="নাম লিখুন" style="width:100%;max-width:300px;padding:0.5rem;border-radius:6px;border:1.5px solid #0052cc; margin-bottom: 0.7rem;" autocomplete="off"/>
      <button id="saveProfileBtn" style="width:150px;">সংরক্ষণ করুন</button>
      <div id="profileInfo" style="margin-top:0.75rem; display:none;">
        <p><strong>নাম:</strong> <span id="savedProfileName"></span></p>
        <p><strong>ব্যবহারকারী আইডি:</strong> <span id="savedProfileUserId"></span></p>
        <button id="editProfileBtn" style="background:#003a99; margin-top: 0.8rem;">প্রোফাইল সম্পাদনা করুন</button>
      </div>
    </section>

    <!-- TABS -->
    <nav class="tabs" role="tablist" aria-label="অ্যাপ ট্যাব">
      <button role="tab" id="practiceTab" aria-selected="true" tabindex="0" class="active">বাসা প্র্যাকটিস</button>
      <button role="tab" id="quizTab" aria-selected="false" tabindex="-1">কুইজ</button>
    </nav>

    <!-- PRACTICE -->
    <section id="practiceSection" role="tabpanel" tabindex="0" style="margin-top: 1rem;">
      <h2 id="practiceTitle">বাসা প্র্যাকটিস</h2>
      <div class="ad-banner" id="adTop" tabindex="0" aria-label="শীর্ষ বিজ্ঞাপন">বিজ্ঞাপন স্পেস: শীর্ষ বিজ্ঞাপন</div>
      <div class="table-container" aria-label="বাসা প্র্যাকটিস টেবিল">
        <table>
          <thead>
            <tr>
              <th>বাংলা</th>
              <th id="langHeader">স্থানীয় ভাষা</th>
              <th>উচ্চারণ (ইংরেজি)</th>
              <th>ইংরেজি অর্থ</th>
            </tr>
          </thead>
          <tbody id="practiceTableBody"></tbody>
        </table>
      </div>
      <div class="ad-banner" id="adMid" tabindex="0" aria-label="মধ্যবর্তী বিজ্ঞাপন">বিজ্ঞাপন স্পেস: মধ্যবর্তী বিজ্ঞাপন</div>
    </section>

    <!-- QUIZ -->
    <section id="quizSection" role="tabpanel" tabindex="0" style="margin-top: 1rem; display:none;">
      <h2 id="quizTitle">কুইজ</h2>
      <div class="quiz-container" role="region" aria-label="কুইজ প্রশ্ন ও উত্তর নির্বাচন">
        <p id="quizQuestion" class="quiz-question"></p>
        <ul id="quizOptions" class="quiz-options" role="radiogroup" aria-live="polite"></ul>
        <button id="btnSubmitQuiz" class="submit-quiz-btn" aria-label="উত্তর জমা দিন" style="margin-top:0.4rem;">জমা দিন</button>
        <button id="btnRetryQuiz" class="submit-quiz-btn" style="display:none; margin-left: 12px; margin-top:0.4rem;" aria-label="আবার চেষ্টা করুন">আবার চেষ্টা করুন</button>
        <p id="quizFeedback" role="alert" aria-live="assertive"></p>
        <p id="quizScore" style="font-weight:700; margin-top:10px;"></p>
      </div>
      <div class="ad-banner" id="adBottom" tabindex="0" aria-label="তলদেশ বিজ্ঞাপন">বিজ্ঞাপন স্পেস: তলদেশ বিজ্ঞাপন</div>
    </section>
  </div>

</section>

<script>
(() => {
  // Countries data with flags
  const countries = [
    {code:'senzen', name:'সেনজেন', flag:'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Flag_of_Europe.svg/64px-Flag_of_Europe.svg.png', languageTitle:'সেনজেন ভাষা'},
    {code:'muktshopno', name:'মুক্ত স্বপ্ন দেশ', flag:'https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/Flag_of_Bangladesh.svg/64px-Flag_of_Bangladesh.svg.png', languageTitle:'মুক্ত স্বপ্ন দেশের ভাষা'},
    {code:'russia', name:'রাশিয়া', flag:'https://upload.wikimedia.org/wikipedia/en/thumb/f/f3/Flag_of_Russia.svg/64px-Flag_of_Russia.svg.png', languageTitle:'রাশিয়া ভাষা'},
  ];
  // Phrase and quiz data
  const phrasesData = {
    senzen: [
      {bn:"স্বাগতম!", local:"Добро пожаловать!", pron:"Dobro pozhalovat'!", en:"Welcome!" },
      {bn:"আপনি কেমন আছেন?", local:"Как ваши дела?", pron:"Kak vashi dela?", en:"How are you?" },
      {bn:"আমার নাম [নাম]।", local:"Меня зовут [имя].", pron:"Menya zovut [imya].", en:"My name is [name]." },
    ],
    muktshopno: [
      {bn:"স্বাধীনতা আমাদের অধিকার।", local:"Свобода — наше право.", pron:"Svoboda — nashe pravo.", en:"Freedom is our right."},
      {bn:"আমানত রক্ষা করো।", local:"Храни доверие.", pron:"Khrani doverie.", en:"Keep the trust."},
    ],
    russia: [
      {bn:"কোথায় যাব?", local:"Куда пойти?", pron:"Kuda poyti?", en:"Where to go?" },
      {bn:"কি করে যাব?", local:"Как добраться?", pron:"Kak dobrat'sya?", en:"How to get there?" },
      {bn:"বাস কয়টায় ছাড়বে?", local:"Во сколько отходит автобус?", pron:"Vo skol'ko otkhodit avtobus?", en:"What time does the bus leave?" },
    ],
  };
  const quizData = {
    senzen: [
      {question:"‘Welcome!’ এর সেনজেন ভাষায় অনুবাদ কোনটি?", options:["Добро пожаловать!","Как ваши дела?","Меня зовут [имя].","Спасибо!"], answer:"Добро пожаловать!"},
      {question:"‘How are you?’ এর সেনজেন ভাষায় অনুবাদ কোনটি?", options:["Меня зовут [имя].","Как ваши дела?","Добро пожаловать!","До свидания!"], answer:"Как ваши дела?"},
    ],
    muktshopno: [
      {question:"‘স্বাধীনতা আমাদের অধিকার।’ এর ইংরেজি অর্থ কী?", options:["Freedom is our right.","Keep the trust.","Love your country.","Peace for all."], answer:"Freedom is our right."},
      {question:"‘আমানত রক্ষা করো।’ এর মুক্ত স্বপ্ন দেশের ভাষায় অনুবাদ কোনটি?", options:["Храни доверие.","Свобода — наше право.","Мир для всех.","Любовь к стране."], answer:"Храни доверие."},
    ],
    russia: [
      {question:"‘Where is the hospital?’ এর রাশিয়ান অনুবাদ কোনটি?", options:["Где больница?","Где ресторан?","Где мечеть?","Где автобус?"], answer:"Где больница?"},
      {question:"‘I am from Bangladesh.’ এর রাশিয়ান অনুবাদ কোনটি?", options:["Я из Пакистана.","Я из Индии.","Я из Бангладеша.","Я из Китая."], answer:"Я из Бангладеша."},
    ],
  };

  // Elements refs
  const loginPage = document.getElementById('loginPage');
  const appContainer = document.getElementById('appContainer');
  const landingPage = document.getElementById('landingPage');
  const countrySelector = document.getElementById('countrySelector');
  const countryAppContainer = document.getElementById('countryAppContainer');
  const practiceTabBtn = document.getElementById('practiceTab');
  const quizTabBtn = document.getElementById('quizTab');
  const practiceSection = document.getElementById('practiceSection');
  const quizSection = document.getElementById('quizSection');
  const practiceTableBody = document.getElementById('practiceTableBody');
  const quizQuestion = document.getElementById('quizQuestion');
  const quizOptions = document.getElementById('quizOptions');
  const btnSubmitQuiz = document.getElementById('btnSubmitQuiz');
  const btnRetryQuiz = document.getElementById('btnRetryQuiz');
  const quizFeedback = document.getElementById('quizFeedback');
  const quizScore = document.getElementById('quizScore');
  const profileSection = document.getElementById('profileSection');
  const profileMsg = document.getElementById('profileMsg');
  const profileNameInput = document.getElementById('profileNameInput');
  const saveProfileBtn = document.getElementById('saveProfileBtn');
  const profileInfo = document.getElementById('profileInfo');
  const savedProfileName = document.getElementById('savedProfileName');
  const savedProfileUserId = document.getElementById('savedProfileUserId');
  const editProfileBtn = document.getElementById('editProfileBtn');
  const langHeader = document.getElementById('langHeader');
  const practiceTitle = document.getElementById('practiceTitle');
  const quizTitle = document.getElementById('quizTitle');
  const adTop = document.getElementById('adTop');
  const adMid = document.getElementById('adMid');
  const adBottom = document.getElementById('adBottom');
  // Settings menu
  const settingsIcon = document.getElementById('settingsIcon');
  const settingsMenu = document.getElementById('settingsMenu');
  const settingsCloseBtn = document.getElementById('settingsCloseBtn');
  const themeSelect = document.getElementById('themeSelect');

  // Login controls
  const loginButton = document.getElementById('loginButton');
  const firstNameInput = document.getElementById('firstName');
  const lastNameInput = document.getElementById('lastName');
  const passwordInput = document.getElementById('password');
  const loginErrorMsg = document.getElementById('loginErrorMsg');

  let userData = null; // logged in user info
  let selectedCountry = null;
  let profile = {name:'', userId:''};
  let quizCurrentIndex = 0;
  let quizScoreCount = 0;

  // Theme Functions
  function setTheme(theme) {
    if(theme === 'dark'){
      document.body.classList.remove('light-theme');
      document.body.classList.add('dark-theme');
    } else {
      document.body.classList.remove('dark-theme');
      document.body.classList.add('light-theme');
    }
    localStorage.setItem('appTheme', theme);
    themeSelect.value = theme;
  }
  settingsIcon.addEventListener('click', toggleSettingsMenu);
  settingsIcon.addEventListener('keydown', e => {
    if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleSettingsMenu(); }
  });
  settingsCloseBtn.addEventListener('click', closeSettingsMenu);
  settingsCloseBtn.addEventListener('keydown', e => {
    if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); closeSettingsMenu(); }
  });
  themeSelect.addEventListener('change', e => {
    setTheme(e.target.value);
  });
  function toggleSettingsMenu(){
    if(settingsMenu.style.display === 'block') closeSettingsMenu();
    else showSettingsMenu();
  }
  function showSettingsMenu(){
    settingsMenu.style.display = 'block';
    settingsMenu.setAttribute('aria-hidden', 'false');
    settingsCloseBtn.focus();
  }
  function closeSettingsMenu(){
    settingsMenu.style.display = 'none';
    settingsMenu.setAttribute('aria-hidden', 'true');
    settingsIcon.focus();
  }

  // Init
  function init(){
    // Load theme from storage
    setTheme(localStorage.getItem('appTheme') || 'light');
    // Pre-fill login if stored
    const storedFirst = localStorage.getItem('userFirstName') || '';
    const storedLast = localStorage.getItem('userLastName') || '';
    firstNameInput.value = storedFirst;
    lastNameInput.value = storedLast;
    showLoginView();
  }
  // Show login view
  function showLoginView(){
    loginPage.style.display = 'flex';
    appContainer.style.display = 'none';
  }
  // Show app landing view (country select)
  function showAppLanding(){
    loginPage.style.display = 'none';
    appContainer.style.display = 'flex';
    landingPage.style.display = 'flex';
    countryAppContainer.style.display = 'none';
    populateCountries();
    // Reset profile UI, quiz etc
    resetProfileUI();
    clearQuizReset();
  }
  // Populate countries on landing page
  function populateCountries(){
    countrySelector.innerHTML = '';
    countries.forEach(c => {
      const card = document.createElement('div');
      card.className = 'country-card';
      card.setAttribute('tabindex', '0');
      card.setAttribute('role', 'listitem');
      card.setAttribute('aria-label', c.name);
      card.dataset.code = c.code;
      card.innerHTML = \`
        <img src="\${c.flag}" alt="\${c.name} এর পতাকা" loading="lazy" />
        <span>\${c.name}</span>
      \`;
      card.addEventListener('click', () => {
        selectCountryAndLoadApp(c.code);
      });
      card.addEventListener('keydown', e => {
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          selectCountryAndLoadApp(c.code);
        }
      });
      countrySelector.appendChild(card);
    });
  }
  // On country select, load country app UI
  function selectCountryAndLoadApp(code){
    selectedCountry = countries.find(c => c.code === code);
    if(!selectedCountry) return;
    landingPage.style.display = 'none';
    countryAppContainer.style.display = 'flex';
    langHeader.textContent = selectedCountry.languageTitle;
    practiceTitle.textContent = \`\${selectedCountry.languageTitle} বাসা প্র্যাকটিস\`;
    quizTitle.textContent = \`\${selectedCountry.languageTitle} কুইজ\`;
    adTop.textContent = \`\${selectedCountry.name} শীর্ষ বিজ্ঞাপন - আপনার বিজ্ঞাপন এখানে\`;
    adMid.textContent = \`\${selectedCountry.name} মধ্যবর্তী বিজ্ঞাপন - বিজ্ঞাপন স্পেস\`;
    adBottom.textContent = \`\${selectedCountry.name} তলদেশ বিজ্ঞাপন - বিজ্ঞাপন স্পেস\`;
    loadStoredProfile();
    loadPracticeData();
  }
  // Login submit logic
  loginButton.addEventListener('click', () => {
    const fName = firstNameInput.value.trim();
    const lName = lastNameInput.value.trim();
    const pwd = passwordInput.value;
    loginErrorMsg.textContent = '';

    if(!fName || !lName || !pwd){
      loginErrorMsg.textContent = 'দয়া করে সব তথ্য পূরণ করুন।';
      return;
    }
    // Save (simulate auth)
    localStorage.setItem('userFirstName', fName);
    localStorage.setItem('userLastName', lName);
    localStorage.setItem('userPassword', pwd); // For demo only!
    userData = {firstName:fName, lastName:lName, password:pwd};
    loginErrorMsg.textContent = '';
    showAppLanding();
  });

  // Profile handlers
  saveProfileBtn.addEventListener('click', () => {
    const profName = profileNameInput.value.trim();
    if(!profName){
      profileMsg.style.color = 'red';
      profileMsg.textContent = 'দয়া করে নাম দিন।';
      return;
    }
    profile.name = profName;
    profile.userId = generateUserId();
    // Save per country profile in localStorage
    localStorage.setItem(\`profileName_\${selectedCountry.code}\`, profile.name);
    localStorage.setItem(\`profileUserId_\${selectedCountry.code}\`, profile.userId);
    profileMsg.style.color = 'green';
    profileMsg.textContent = 'প্রোফাইল সফলভাবে তৈরি হয়েছে।';
    showProfileInfo();
  });
  editProfileBtn.addEventListener('click', () => {
    profileNameInput.style.display = 'block';
    saveProfileBtn.style.display = 'inline-block';
    profileInfo.style.display = 'none';
    profileMsg.textContent = '';
    profileNameInput.value = profile.name;
  });

  function showProfileInfo(){
    profileMsg.textContent = '';
    profileNameInput.style.display = 'none';
    saveProfileBtn.style.display = 'none';
    profileInfo.style.display = 'block';
    savedProfileName.textContent = profile.name;
    savedProfileUserId.textContent = profile.userId;
  }
  // Load stored profile if exists
  function loadStoredProfile(){
    profile.name = localStorage.getItem(\`profileName_\${selectedCountry.code}\`)||'';
    profile.userId = localStorage.getItem(\`profileUserId_\${selectedCountry.code}\`)||'';
    if(profile.name && profile.userId){
      showProfileInfo();
    } else {
      profileNameInput.style.display = 'block';
      saveProfileBtn.style.display = 'inline-block';
      profileInfo.style.display = 'none';
      profileMsg.textContent = '';
      profileNameInput.value = '';
    }
  }
  // Generate user id
  function generateUserId(){
    return Math.random().toString(36).substr(2,8).toUpperCase();
  }
  // Load practice table data
  function loadPracticeData(){
    practiceTableBody.innerHTML = '';
    if(!selectedCountry) return;
    const data = phrasesData[selectedCountry.code] || [];
    data.forEach(({bn,local,pron,en})=>{
      const tr = document.createElement('tr');
      tr.innerHTML = \`
        <td>\${bn}</td>
        <td>\${local}</td>
        <td>\${pron}</td>
        <td>\${en}</td>
      \`;
      practiceTableBody.appendChild(tr);
    });
  }
  // Tabs logic
  practiceTabBtn.addEventListener('click', () => {
    practiceTabBtn.classList.add('active');
    practiceTabBtn.setAttribute('aria-selected','true');
    practiceTabBtn.tabIndex = 0;
    quizTabBtn.classList.remove('active');
    quizTabBtn.setAttribute('aria-selected','false');
    quizTabBtn.tabIndex = -1;
    practiceSection.style.display = 'block';
    quizSection.style.display = 'none';
    clearQuizReset();
  });
  quizTabBtn.addEventListener('click', () => {
    quizTabBtn.classList.add('active');
    quizTabBtn.setAttribute('aria-selected','true');
    quizTabBtn.tabIndex = 0;
    practiceTabBtn.classList.remove('active');
    practiceTabBtn.setAttribute('aria-selected','false');
    practiceTabBtn.tabIndex = -1;
    practiceSection.style.display = 'none';
    quizSection.style.display = 'block';
    startQuiz();
  });

  // Quiz logic
  btnSubmitQuiz.addEventListener('click', () => {
    const selectedOpt = quizOptions.querySelector('input[name="quizOption"]:checked');
    if(!selectedOpt){
      quizFeedback.textContent = 'অনুগ্রহ করে একটি উত্তর নির্বাচন করুন।';
      quizFeedback.className = 'incorrect';
      return;
    }
    const currentQ = (quizData[selectedCountry.code] || [])[quizCurrentIndex];
    if(!currentQ) return;

    if(selectedOpt.value === currentQ.answer){
      quizScoreCount++;
      quizFeedback.textContent = 'সঠিক উত্তর!';
      quizFeedback.className = 'correct';
    } else {
      quizFeedback.textContent = \`ভুল উত্তর। সঠিক উত্তর: \${currentQ.answer}\`;
      quizFeedback.className = 'incorrect';
    }
    quizCurrentIndex++;
    btnSubmitQuiz.style.display = 'none';
    setTimeout(() => {
      quizFeedback.textContent = '';
      btnSubmitQuiz.style.display = 'inline-block';
      renderQuizQuestion();
    }, 2000);
  });

  btnRetryQuiz.addEventListener('click', () => {
    startQuiz();
  });

  function renderQuizQuestion(){
    const qlist = quizData[selectedCountry.code] || [];
    const q = qlist[quizCurrentIndex];
    if(!q){
      showQuizResult();
      return;
    }
    quizQuestion.textContent = q.question;
    quizOptions.innerHTML = '';
    q.options.forEach((op,i)=>{
      const li = document.createElement('li');
      const id = \`quizOpt\${i}\`;
      li.innerHTML = \`
        <input type="radio" name="quizOption" id="\${id}" value="\${op}">
        <label for="\${id}">\${op}</label>
      \`;
      quizOptions.appendChild(li);
    });
  }
  function startQuiz(){
    quizCurrentIndex=0;
    quizScoreCount=0;
    renderQuizQuestion();
    quizFeedback.textContent = '';
    quizScore.textContent = '';
    btnSubmitQuiz.style.display = 'inline-block';
    btnRetryQuiz.style.display = 'none';
  }
  function showQuizResult(){
    quizQuestion.textContent = 'আপনি কুইজ শেষ করেছেন!';
    quizOptions.innerHTML = '';
    quizScore.textContent = \`আপনার পয়েন্ট: \${quizScoreCount} / \${(quizData[selectedCountry.code]||[]).length}\`;
    quizFeedback.textContent = '';
    btnSubmitQuiz.style.display = 'none';
    btnRetryQuiz.style.display = 'inline-block';
  }
  function clearQuizReset(){
    quizQuestion.textContent = '';
    quizOptions.innerHTML = '';
    quizFeedback.textContent = '';
    quizScore.textContent = '';
    btnSubmitQuiz.style.display = 'none';
    btnRetryQuiz.style.display = 'none';
  }

  // Initialize app on load
  init();

})();
</script>

</body>
</html>

